<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ã‚«ã‚ªã‚¹ãƒ»ã‚¯ãƒƒã‚­ãƒ³ã‚°ãƒ»ã‚­ãƒ£ãƒƒãƒ</title>
    <style>
        body { text-align: center; background: #f0f0f0; font-family: sans-serif; overflow: hidden; margin: 0; }
        canvas { 
            background: #fff; 
            border: 4px solid #333; 
            max-width: 100%; /* ã‚¹ãƒãƒ›ç”»é¢ã‹ã‚‰ã¯ã¿å‡ºã•ãªã„ */
            height: auto; 
            touch-action: none; /* æŒ‡ã§è§¦ã‚ŒãŸæ™‚ã«ç”»é¢ãŒæºã‚Œã‚‹ã®ã‚’é˜²ã */
        }
        #result { display: none; position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);
                  background: rgba(255,255,255,0.95); padding: 20px; border-radius: 20px; border: 5px solid #ff5722; width: 80%; }
        button { font-size: 20px; padding: 10px 20px; border-radius: 10px; background: #ff5722; color: white; border: none; cursor: pointer; }
    </style>
</head>
<body>
    <h1>å¤‰ãªæ–™ç†ã‚’ä½œã‚ã†ï¼</h1>
    <p>å·¦å³ã«å‹•ã‹ã—ã¦ææ–™ã‚’10å€‹æ‹¾ãˆï¼</p>
    <canvas id="gameCanvas" width="600" height="400"></canvas>

    <div id="result">
        <h2 id="dishName"></h2>
        <p id="dishDesc"></p>
        <button onclick="location.reload()">ã‚‚ã†ä¸€åº¦ä½œã‚‹</button>
    </div>

<script>
const canvas = document.getElementById("gameCanvas");
const ctx = canvas.getContext("2d");
const resultDiv = document.getElementById("result");

const items = [
    { name: 'ã‚¤ãƒã‚´', icon: 'ğŸ“', type: 'sweet' },
    { name: 'ã‚µãƒ', icon: 'ğŸŸ', type: 'fish' },
    { name: 'ãƒã‚¸', icon: 'ğŸ”©', type: 'metal' },
    { name: 'è¬ã®æ¶²ä½“', icon: 'ğŸ§ª', type: 'weird' },
    { name: 'ã‚±ãƒ¼ã‚­', icon: 'ğŸ°', type: 'sweet' },
    { name: 'ã‚¿ã‚¤ãƒ¤', icon: 'ğŸ›', type: 'gross' }
];

let basket = { x: 250, y: 350, width: 80, height: 40 };
let fallingItems = [];
let caughtItems = [];
let score = 0;
let gameOver = false;

// --- ã“ã“ã‹ã‚‰ã‚¹ãƒãƒ›ãƒ»PCå…±é€šã®æ“ä½œå‡¦ç† ---

function moveBasket(clientX) {
    let rect = canvas.getBoundingClientRect();
    // ç”»é¢ã‚µã‚¤ã‚ºã«å¯¾ã™ã‚‹ãƒã‚¦ã‚¹/æŒ‡ã®æ¯”ç‡ã‚’è¨ˆç®—ã—ã¦é‹ã‚’å‹•ã‹ã™
    let scaleX = canvas.width / rect.width;
    basket.x = (clientX - rect.left) * scaleX - basket.width / 2;
}

// ãƒã‚¦ã‚¹æ“ä½œ
canvas.addEventListener('mousemove', (e) => {
    moveBasket(e.clientX);
});

// ã‚¿ãƒƒãƒæ“ä½œï¼ˆã‚¹ãƒãƒ›ï¼‰
canvas.addEventListener('touchmove', (e) => {
    e.preventDefault(); // ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«é˜²æ­¢
    moveBasket(e.touches[0].clientX);
}, { passive: false });

// --- ã“ã“ã¾ã§ ---

function spawnItem() {
    if (gameOver) return;
    const item = items[Math.floor(Math.random() * items.length)];
    fallingItems.push({ ...item, x: Math.random() * (canvas.width - 30), y: -30, speed: 2 + Math.random() * 3 });
    setTimeout(spawnItem, 800);
}

function update() {
    if (gameOver) return;
    fallingItems.forEach((item, index) => {
        item.y += item.speed;
        if (item.y + 30 > basket.y && item.x > basket.x && item.x < basket.x + basket.width) {
            caughtItems.push(item);
            fallingItems.splice(index, 1);
            score++;
            // ã‚¹ãƒãƒ›ãªã‚‰æŒ¯å‹•ã•ã›ã‚‹ï¼ˆå¯¾å¿œæ©Ÿç¨®ã®ã¿ï¼‰
            if (window.navigator.vibrate) window.navigator.vibrate(50);
            if (score >= 10) finishGame();
        }
        if (item.y > canvas.height) fallingItems.splice(index, 1);
    });
}

function draw() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    ctx.fillStyle = "#555";
    ctx.fillRect(basket.x, basket.y, basket.width, basket.height);
    ctx.font = "20px Arial";
    ctx.fillText("ğŸ²é‹", basket.x + 15, basket.y + 25);
    fallingItems.forEach(item => {
        ctx.font = "30px Arial";
        ctx.fillText(item.icon, item.x, item.y);
    });
    if (!gameOver) requestAnimationFrame(() => { update(); draw(); });
}

function finishGame() {
    gameOver = true;
    resultDiv.style.display = "block";
    const prefixes = ["ä¼èª¬ã®", "è™šç„¡ã®", "ãƒ‰ãƒ­ãƒ‰ãƒ­ãª", "ãƒ”ã‚«ãƒ”ã‚«ã®", "é­”ç•Œã®"];
    const suffixes = ["ã‚¹ãƒ¼ãƒ—", "ç‚’ã‚", "ã‚µãƒ©ãƒ€", "ç…®è¾¼ã¿", "ã‚ªãƒ–ã‚¸ã‚§"];
    let name = prefixes[Math.floor(Math.random() * prefixes.length)] + 
               caughtItems[0].name + "ã¨" + caughtItems[caughtItems.length-1].name + "ã®" +
               suffixes[Math.floor(Math.random() * suffixes.length)];
    document.getElementById("dishName").innerText = "å®Œæˆï¼\n" + name;
    document.getElementById("dishDesc").innerText = caughtItems.map(i => i.icon).join("") + "\nã‚’æ··ãœã¦ã¿ãŸãï¼";
}

spawnItem();
draw();
</script>
</body>
</html>
